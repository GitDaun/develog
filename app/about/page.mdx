# [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항
## [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항
### [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항
#### [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항
##### [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항
###### [NEXT.js] unsupported opentype signature wOF2 - OG 이미지, ImageResponse 적용 시, 유의사항  



Next.js에서 ImageResponse로 동적 OG 이미지를 만들 때, 멋진 커스텀 폰트를 사용하려다 unsupported opentype signature wOF2 라는 오류 메시지를 만나셨나요?

이 글에서는 왜 이 오류가 발생하는지, 그리고 어떻게 해결할 수 있는지 공유하려 합니다.

더불어 OG 이미지를 설정하는 다양한 방법과 팁까지 함께 알아보겠습니다.

🚨 제가 마주한 'wOF2' 폰트 오류 (그리고 해결책)

저 역시 레트로한 느낌을 주기 위해 ' DungGeunMo.woff2 ' 폰트를 사용하던 중 이 오류를 만났습니다.

원인은 간단했습니다. Next.js의 ImageResponse는 아직 woff2 포맷을 지원하지 않습니다.

(ttf, otf, woff 글꼴 형식만 지원됩니다. 글꼴 구문 분석 속도를 최대화하려면 ttf 또는 otf가 woff보다 선호됩니다.)

https://nextjs.org/docs/app/api-reference/functions/image-response

해결 방법:

폰트 변환: woff2 폰트를 ttf 또는 otf 포맷으로 변환합니다. (추천 변환 사이트: [링크])

코드 수정: 변환된 폰트 파일을 프로젝트에 넣고, readFile 경로를 수정해주면 끝입니다.

하지만 내일 다시 잊어버리고 삽질할 나를 위해 좀 더 정리해 보기로 합니다......
## OG 이미지란?

OG (Open Graph) 이미지는 페이스북, 트위터 등에서 링크를 공유할 때 나오는 대표 썸네일 이미지를 의미합니다.

Next.js에서는 정적(고정) 이미지와 동적(코드 생성) 이미지 모두 지원하며, SEO와 소셜 미리보기 최적화에 필수입니다....
### OG 이미지 설정 방식

1. 정적 이미지 방식 (opengraph-image.png)

간단하고, 변하지 않는 페이지에 사용합니다

opengraph-image.png, twitter-image.png 파일을 해당 라우트 폴더에 두면 Next.js가 정적 OG 이미지로 자동 반영합니다.

about 세그먼트 아래에 opengraph-image.png를 새로 만든 후, http://localhost:3000/about 로 접근을 하면

meta 태그에 아래와 같은 정보가 반영되는 것을 확인할 수 있습니다.

추가 정보가 필요 없고, 같은 폴더에서의 파일 관리가 목적이라면 효과적입니다.

그리고 이미지 파일과 동일한 경로에 opengraph-image.alt.txt 파일을 작성하면 이미지의 alt 텍스트가 자동으로 메타데이터에 반영된다(Next.js 15 기준).

단, 이 방식은 파일명과 위치 규칙을 반드시 지켜야 하며, 한 페이지만 여러 이미지를 쓰는 상황 등 세부 설정은 불가능하다.
#### 2. metadata 객체 방식

이 방식은 이미 만들어져 있는 이미지 파일의 주소(URL)를 직접 지정하는 것입니다.

외부 이미지(CDN 등), 여러 이미지 배열, alt, width, height 등 세부 정보를 모두 명시할 수 있고,

각 이미지의 정보를 코드로 더욱 유연하게 지정하거나, 설정 파일이나 환경변수를 통해 일괄 관리에도 적합합니다.

단, 같은 경로에 opengraph-image.png가 있으면 해당 파일이 우선 적용되어, metadata 객체 설정은 무시됩니다.

```javascript
export const metadata = {

  title: '예시 블로그 제목',

  description: 'SEO와 소셜 공유 미리보기 최적화 안내.',

  openGraph: {

    title: 'OG 타이틀',

    description: 'OG 설명',

    type: 'article',

    url: 'https://your-site.com/post/123',

    images: [
    
    { url: 'https://your-site.com/images/og1.png', width: 1200, height: 630, alt: '미리보기 1번' },

    { url: 'https://your-site.com/images/og2.jpg', width: 600, height: 315, alt: '미리보기 2번' },

    ],

  },

  twitter: {

    card: 'summary_large_image',

    title: '트위터 카드 타이틀',

    description: '트위터 카드 설명',

    images: [

      'https://your-site.com/images/twitter1.png',

      'https://your-site.com/images/twitter2.png'

    ],

},

// 기타 SEO 관련 메타데이터 같이 추가 가능

};

```


그럼 metadata 객체를 이용하는 방법과 opengraph-image.png 의 차이는 어떤 것이고 언제 선택을 해야할까요?

핵심적인 차이는 "어디에 있는 이미지를 어떻게 지정하는가" 와 "설정의 유연성 및 우선순위" 입니다.

opengraph-image.png 방식이 더 좋을 때:

1. 가장 간단하고 빠르게 OG 이미지를 설정하고 싶을 때.

2. 페이지 파일(page.tsx)과 OG 이미지를 같은 곳에 두고 관리하고 싶을 때 (Co-location).

3. 별도의 추가 정보(alt 텍스트 등)가 필요 없을 때.

metadata 객체 방식이 더 좋을 때:

1. 이미지를 CDN 같은 외부 서비스에 두고 관리할 때.

2. 하나의 페이지에 여러 개의 OG 이미지를 설정하거나, 상세한 정보를 제공하고 싶을 때.

3. 프로젝트의 모든 OG 이미지 URL을 한 곳(예: 환경 변수나 설정 파일)에서 관리하고 싶을 때.

|구분|opengraph-image.png 방식|metadata 객체 방식|
|--|--|--|
|설정 방법|파일 기반 (Convention) : 규칙에 맞는 이름의 파일을 폴더에 두기만 하면 끝.|코드 기반 (Configuration): metadata 객체 안에이미지 URL을 직접 명시.|
|이미지 위치|해당 라우트 폴더 내(예: app/about/opengraph-image.png)|어디든 가능public 폴더, 외부 CDN 등 절대 경로 URL만 있으면 됨.|
|추가 정보|설정 불가.Next.js가 이미지 크기 등을 자동으로 감지.|설정 가능. 이미지의 width, height, alt 텍스트 등 세부 정보를 함께 제공 가능.|
|유연성|낮음.정해진 파일명과 위치 규칙을반드시 따라야 함.|높음.하나의 페이지에 여러 개의OG 이미지를 배열로 설정 가능.|
|우선순위|높음. 이 파일이 존재하면 metadata 객체의openGraph.images 설정은 무시됨.|낮음. opengraph-image.png 파일이같은 경로에 있으면 적용되지 않음.|

#### 3. 동적 이미지

게시글마다 OG 이미지를 동적으로 바꾸고 싶으면

**opengraph-image.tsx** 파일을 만들어, ImageResponse(예: @next/og)를 사용해 이미지를 코드(React/JSX)로 만들어 반환합니다. 각기 다른 콘텐츠를 가진 페이지에 맞춤형 이미지를 제공하기 위해 사용하는 동적 이미지는 런타임(rutime) 설정이 중요합니다.

#### 런타임( runtime ) 설정, 체크하기!

- ImageResponse(next/og)는 Edge와 Node.js 두 가지 런타임 모두 지원합니다.

- Next 15.2 부터 실험 모드에서 Node.js 버전을 지원하기 시작하여 15.5 버전에서는 정식지원 합니다.

- 코드 맨 위에 아래 코드를 명시적으로 사용하세요 (안 쓰면 기본값은 'edge')

`export const runtime = 'edge' // 또는 'nodejs'`

#### Edge 런타임과 Node.js 런타임, 뭐가 다른가요?

- Edge:

- 외부 리소스(폰트/이미지 등)는 fetch로만 불러와야 합니다.

- fs, path 같은 Node.js 내장 모듈은 쓸 수 없습니다.

- 응답 속도가 빠르며, Verce에서 안정적으로 지원됩니다.

- Node.js:

- 서버 파일에 직접 접근이 가능.(fs.readFile 등)

- 복잡하거나 보안이 필요한 작업, 로컬 리소스 접근 시 사용.

- 단, 배포 환경(클라우드 서버)마다 실제 파일 경로나 권한엔 주의가 필요합니다.

- 속도는 Edge 보다 느릴 수 있습니다.... #### 폴백 이미지

동적 이미지 방식을 사용할 때는 이미지 생성에 실패했을 때를 대비해서 폴백 이미지도 준비해야 합니다.

아래와 같은 이유들로 이미지 생성을 못할 수도 있기 때문입니다.

- 데이터 페칭 실패: 게시물 정보를 가져오는 getPostBySlug와 같은 함수가 실패할 경우 (예: API 오류, 데이터베이스 연결 문제).

- 렌더링 오류: ImageResponse 내부의 JSX/CSS 코드에 버그가 있을 경우.

- 외부 리소스 로드 실패: 이미지 내에서 사용하는 커스텀 폰트나 다른 이미지를 불러오지 못할 경우.

순서는 다음과 같습니다

- 메인 로직을 try...catch 블록으로 감싸 에러를 처리합니다.

- params.slug에 해당하는 제목이 titles 객체에 없는 경우, 에러를 발생시켜 catch 블록으로 넘깁니다.

- 에러 발생 시(catch 블록 실행 시), 폰트나 외부 이미지 없이 안전하게 렌더링될 수 있는 기본 폴백 이미지를 반환하도록 합니다.

- 가독성을 위해 폴백 이미지를 별도의 컴포넌트로 분리합니다(단, 예제에서는 한눈에 보기 쉽도록 분리하지 않았습니다)

